<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://ezrilei.github.io</id>
    <title>my blog</title>
    <updated>2021-07-06T00:30:33.599Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://ezrilei.github.io"/>
    <link rel="self" href="https://ezrilei.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://ezrilei.github.io/images/avatar.png</logo>
    <icon>https://ezrilei.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, my blog</rights>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨Rè¯­è¨€æ‰¹é‡å†™wordæ–‡æ¡£]]></title>
        <id>https://ezrilei.github.io/post/shi-yong-r-yu-yan-pi-liang-xie-word-wen-dang/</id>
        <link href="https://ezrilei.github.io/post/shi-yong-r-yu-yan-pi-liang-xie-word-wen-dang/">
        </link>
        <updated>2021-07-06T00:26:22.000Z</updated>
        <content type="html"><![CDATA[<h2 id="åŸç†">åŸç†</h2>
<p>å‘å±•å…šå‘˜çš„æ‰¹æ–‡æœ‰æ—¢å®šçš„æ¨¡æ¿ã€‚è¿™æ ·åœ¨å¬å¼€å…šå§”ä¼šé›†ä½“ç ”ç©¶å†³å®šåï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠå‰æœŸæ”¶é›†çš„.xlsxè¡¨æ ¼ä¸­çš„ä¿¡æ¯ï¼Œå¡«å†™åˆ°ä½œä¸ºæ¨¡æ¿çš„wordæ–‡æ¡£ä¸­çš„å¯¹åº”ä½ç½®å³å¯ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿å®šä½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ¶ä½œæ¨¡æ¿æ—¶ï¼Œå°±æŠŠè¦å¡«å†™çš„åœ°æ–¹åšå¥½æ ‡è®°ã€‚æ¯”å¦‚ä½¿ç”¨å…³é”®è¯<code>name.person</code>ï¼ˆå‘å±•å¯¹è±¡çš„å§“åï¼‰ã€<code>name.cpc.branch</code>ï¼ˆå…šæ”¯éƒ¨åç§°ã€‚å¦‚æœæ‰¹æ–‡ä¸‹å‘åˆ°å…šæ€»æ”¯æˆ–è€…ç¤¾åŒºå…šå§”ï¼Œè¿™é‡Œä¸ºå…šæ€»æ”¯åç§°æˆ–ç¤¾åŒºå…šå§”åç§°ï¼‰ã€<code>serial_num</code>ï¼ˆé¢„å®¡é€šè¿‡åå°†ä¸‹å‘ã€Šå…¥å…šå¿—æ„¿ä¹¦ã€‹ï¼Œè¿™é‡Œä¸ºçœå§”ç»Ÿä¸€å°åˆ¶çš„ã€Šå…¥å…šå¿—æ„¿ä¹¦ã€‹ç¼–å·ï¼‰ã€‚</p>
<p>package <code>xlsx</code>ç”¨äºè¯»å–.xlsxè¡¨æ ¼ã€‚<br>
package <code>officer</code>ç”¨äºå¤„ç†.docxæ–‡æ¡£ã€‚åŒ…æ‹¬è¯»å–æ–‡æ¡£ï¼Œæ›¿æ¢å…³é”®è¯ï¼Œæ·»åŠ åˆ†é¡µç¬¦ï¼Œè¾“å‡º.docxæ–‡æ¡£ã€‚<br>
package<code>stringr</code>ç”¨äºæ–‡æœ¬å¤„ç†ï¼Œåœ¨æ ‡è®°è¾“å‡ºæ–‡æ¡£é¡ºåºçš„æ—¶å€™ã€‚ ï¼ˆå¦‚æœä¸æ ‡è®°é¡ºåºï¼Œåˆå¹¶çš„æ–‡æ¡£å¯èƒ½æ˜¯æ ¹æ®a-zçš„é¡ºåºæ’åˆ—çš„ï¼Œè€Œä¸æ˜¯è¡¨æ ¼ä¸­çš„åºå·ã€‚ï¼‰</p>
<hr>
<h2 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h2>
<ul>
<li>å‡†å¤‡åŒ…å«æ‰¹æ–‡æ‰€éœ€ä¿¡æ¯çš„.xlsxè¡¨æ ¼</li>
<li>å‡†å¤‡ä½œä¸ºæ‰¹æ–‡æ¨¡æ¿çš„.docxæ–‡æ¡£</li>
</ul>
<hr>
<h2 id="set-up">set up</h2>
<pre><code class="language-r">setwd(&quot;~/.../RwkSpace&quot;)

library(xlsx)
library(officer)
library(stringr)

# create dir
if (!dir.exists('output')) {
  dir.create('output')
}
</code></pre>
<h2 id="è¯»å–xlsx">è¯»å–.xlsx</h2>
<p>è°ƒç”¨xlsx package çš„ read.xlsxå‡½æ•°  è¯»å–.xlsxè¡¨æ ¼<br>
ç¨åå°†æŠŠ .xlsxè¡¨æ ¼ä¸­çš„ä¿¡æ¯ å¡«å†™åˆ°æ‰¹æ–‡ä¸­ã€‚</p>
<pre><code class="language-r">info.tt &lt;- read.xlsx(file = &quot;./2021å¹´ç¬¬ä¸€æ‰¹å‘å±•å¯¹è±¡_ä¿¡æ¯é‡‡é›†.xlsx&quot;,
                     sheetIndex = 3, startRow = 2, stringsAsFactors = FALSE
                     ) 
</code></pre>
<h2 id="å¾ªç¯æ›¿æ¢æ¨¡æ¿ä¸­çš„æ–‡å­—">å¾ªç¯æ›¿æ¢æ¨¡æ¿ä¸­çš„æ–‡å­—</h2>
<pre><code class="language-r">#### write word documents ####
for(i in 1:nrow(info.tt)){
  # è¯»å– æ¨¡æ¿.docx
  officer_doc &lt;- officer::read_docx(path = &quot;./ã€æ¨¡æ¿ã€‘é¢„å®¡æ„è§.docx&quot;)
  
  # def variable
  name.person &lt;- info.tt$å§“å[i]
  name.cpc.branch &lt;- info.tt$æ‰¹å¤ä¸‹å‘åˆ°çš„å…šæ”¯éƒ¨[i]
  serial_num &lt;- info.tt$å…¥å…šå¿—æ„¿ä¹¦ç¼–å·[i] %&gt;% as.character()
  
  # æ›¿æ¢
  doc_replaced &lt;- officer_doc %&gt;%
    body_replace_all_text(old_value = &quot;name.person&quot;, 
                          new_value = name.person, 
                          only_at_cursor = FALSE
    ) %&gt;%
    body_replace_all_text(old_value = &quot;name.cpc.branch&quot;, 
                          new_value = name.cpc.branch, 
                          only_at_cursor = FALSE
    ) %&gt;% 
    body_replace_all_text(old_value = &quot;serial_num&quot;, 
                          new_value = serial_num, 
                          only_at_cursor = FALSE
                          )
                          
  # &quot;./output/ã€å¼ ä¸‰ã€‘é¢„å®¡çš„æ„è§.docx&quot;
  print(doc_replaced, 
        target = paste0(&quot;./output/&quot;, i,&quot;ã€&quot;, name.person, &quot;ã€‘&quot;, &quot;é¢„å®¡çš„æ„è§.docx&quot;)
  )

}
</code></pre>
<h2 id="merge-all-word-docx-into-a-single-file">merge all word docx into a single file</h2>
<p>ä¸ºäº†æ–¹ä¾¿æ‰“å° å°†ç”Ÿæˆçš„æ•°ä¸ªwordæ–‡æ¡£ åˆå¹¶æˆä¸€ä¸ªæ–‡æ¡£ ä¸­é—´ç”¨åˆ†é¡µç¬¦éš”å¼€</p>
<pre><code class="language-r">#### merge all word docx ####
# get ordered
doc.path &lt;- paste0(&quot;./output/&quot;, 
                   list.files(path = &quot;./output&quot;)
)
idx &lt;- doc.path %&gt;% str_extract_all(pattern = &quot;\\d+&quot;) %&gt;% unlist() %&gt;% as.numeric() %&gt;% order() 
doc.path &lt;- doc.path[idx]

# merge doc
doc_merge &lt;- officer::read_docx(path = doc.path[1])

for(i in 2:length(doc.path)){
  doc_merge &lt;- doc_merge %&gt;%
    body_add_break() %&gt;% # add a page break into an rdocx object
    body_add_docx(src = doc.path[i]) # add content of a docx into an rdocx object
}


print(doc_merge, 
      target = paste0(&quot;./&quot;, &quot;ã€&quot;, &quot;All&quot;, &quot;ã€‘&quot;, &quot;é¢„å®¡çš„æ„è§.docx&quot;)
)
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Testing]]></title>
        <id>https://ezrilei.github.io/post/testing/</id>
        <link href="https://ezrilei.github.io/post/testing/">
        </link>
        <updated>2021-07-05T14:36:02.000Z</updated>
        <content type="html"><![CDATA[<p>A test</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://ezrilei.github.io/post/hello-gridea/</id>
        <link href="https://ezrilei.github.io/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>