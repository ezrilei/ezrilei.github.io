<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://ezrilei.github.io</id>
    <title>my blog</title>
    <updated>2021-08-22T11:45:30.418Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://ezrilei.github.io"/>
    <link rel="self" href="https://ezrilei.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://ezrilei.github.io/images/avatar.png</logo>
    <icon>https://ezrilei.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, my blog</rights>
    <entry>
        <title type="html"><![CDATA[Solutionï¼šinsert pdf to a blog page]]></title>
        <id>https://ezrilei.github.io/post/inser-pdf-to-a-blog-page/</id>
        <link href="https://ezrilei.github.io/post/inser-pdf-to-a-blog-page/">
        </link>
        <updated>2021-08-21T15:30:20.000Z</updated>
        <summary type="html"><![CDATA[<p>display pdf files via <code>Google Drive Viewer</code> API</p>
<pre><code>&lt;iframe src=&quot;https://docs.google.com/gview?embedded=true&amp;url=http://infolab.stanford.edu/pub/papers/google.pdf&quot; style=&quot;width:800px; height:500px;&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;
</code></pre>
]]></summary>
        <content type="html"><![CDATA[<p>display pdf files via <code>Google Drive Viewer</code> API</p>
<pre><code>&lt;iframe src=&quot;https://docs.google.com/gview?embedded=true&amp;url=http://infolab.stanford.edu/pub/papers/google.pdf&quot; style=&quot;width:800px; height:500px;&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;
</code></pre>
<!-- more -->
<iframe src="https://docs.google.com/gview?embedded=true&url=http://infolab.stanford.edu/pub/papers/google.pdf" style="width:800px; height:500px;" frameborder="0"></iframe>
<hr>
<ul>
<li>å°† github.com æ›¿æ¢ä¸º raw.githubusercontent.com ï¼Œå¹¶å»é™¤ /blob ï¼Œå³ä¸ºè¯¥æ–‡ä»¶çš„ä¸‹è½½é“¾æ¥ã€‚</li>
<li>å°† <code>style=&quot;width:800px; height:500px;&quot;</code> æ”¹ä¸º <code>style=&quot;width: 95%; height: 500px;&quot;</code></li>
<li>å¢åŠ å±…ä¸­<code>&lt;p align=&quot;center&quot;&gt;...&lt;/p&gt;</code></li>
</ul>
<pre><code>&lt;p align=&quot;center&quot;&gt;&lt;iframe src=&quot;https://docs.google.com/gview?embedded=true&amp;url=https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pdf/pdf/%E5%8F%91%E5%B1%95%E5%85%9A%E5%91%98%E6%9D%90%E6%96%99%E6%B8%85%E5%8D%95_v3.2-20210727.pdf&quot; style=&quot;width: 95%; height: 500px;&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/p&gt;
</code></pre>
<p align="center"><iframe src="https://docs.google.com/gview?embedded=true&url=https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pdf/pdf/%E5%8F%91%E5%B1%95%E5%85%9A%E5%91%98%E6%9D%90%E6%96%99%E6%B8%85%E5%8D%95_v3.2-20210727.pdf" style="width: 95%; height: 500px;" frameborder="0"></iframe></p>
<p>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/342135587">å¼ æ™‹, TyporaåµŒå…¥è§†é¢‘å’ŒPDF</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Solutionï¼šMS excel æ‰“å° è·¨é¡µçš„ åˆå¹¶å•å…ƒæ ¼ æ²¡æœ‰ç½‘æ ¼çº¿]]></title>
        <id>https://ezrilei.github.io/post/add-grid-when-printing-merged-cell/</id>
        <link href="https://ezrilei.github.io/post/add-grid-when-printing-merged-cell/">
        </link>
        <updated>2021-08-20T13:00:03.000Z</updated>
        <summary type="html"><![CDATA[<img src="https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pic/img/202108202137594.png" width = "75%" />]]></summary>
        <content type="html"><![CDATA[<img src="https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pic/img/202108202137594.png" width = "75%" />
<!-- more -->
<h2 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h2>
<p>æ‰“å° è·¨é¡µçš„ åˆå¹¶å•å…ƒæ ¼ ä¼šå‡ºç°éƒ¨åˆ†å•å…ƒæ ¼æ²¡æœ‰ç½‘æ ¼çº¿çš„æƒ…å†µ</p>
<img src="https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pic/img/202108201646751.png" width = "75%" />
<h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h2>
<p>é¡µè¾¹è· - ç®¡ç†è‡ªå®šä¹‰é¡µè¾¹è· - é¡µé¢è®¾ç½® - å·¥ä½œè¡¨ - ç½‘æ ¼çº¿â˜‘ï¸</p>
<img src="https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pic/img/202108201650651.png" width = "25%" />
<!-- more -->
<img src="https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pic/img/202108201651612.png" width = "50%" />
<h2 id="ç»“æœ">ç»“æœ</h2>
<p>è·¨é¡µçš„ åˆå¹¶å•å…ƒæ ¼ ä¹Ÿä¼šæ˜¾ç¤ºç½‘æ ¼çº¿äº†<br>
<img src="https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pic/img/202108201652752.png" width = "75%" /></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨Rè¯­è¨€æ‰¹é‡å†™wordæ–‡æ¡£]]></title>
        <id>https://ezrilei.github.io/post/write-word-doc-with-R/</id>
        <link href="https://ezrilei.github.io/post/write-word-doc-with-R/">
        </link>
        <updated>2021-07-06T00:26:22.000Z</updated>
        <summary type="html"><![CDATA[<p>éœ€æ±‚æè¿°ï¼š<br>
å·¥ä½œä¸­ï¼Œæœ‰æ—¶ä¼šé‡åˆ°éœ€è¦æ‰¹é‡å†™wordæ–‡æ¡£çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼Œå†™å‘å±•å…šå‘˜çš„æ‰¹æ–‡çš„æ—¶å€™ã€ä¸´è¿‘èŠ‚å‡æ—¥å†™å›°éš¾å…šå‘˜æ…°é—®ä¿¡çš„æ—¶å€™ã€å‘å±•å¯¹è±¡åŸ¹è®­ç­ç»“ä¸šå†™è¯ä¹¦ã€ç–«æƒ…æœŸé—´æ‰“å°é€šè¿‡å®¡æ ¸çš„é€šè¡Œè¯çš„æ—¶å€™ç­‰ç­‰ã€‚è¿™æ ·çš„æ–‡æ¡£å¤§éƒ¨åˆ†å†…å®¹æ˜¯ä¸å˜çš„ï¼Œåªæœ‰ä¸ªåˆ«å‡ ä¸ªåœ°æ–¹ï¼Œéœ€è¦å†™å…¥ä¿¡æ¯ã€‚è€Œè¿™äº›ä¿¡æ¯å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä»¥è¡¨æ ¼çš„å½¢å¼å‘ˆç°ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ¨ä¸ªæ‰‹åŠ¨å°†ä¿¡æ¯å¡«åˆ°wordæ–‡æ¡£ä¸­ï¼Œ<br>
- ä½†æ˜¯ä¸€æ¥é€Ÿåº¦ä¸å¿«ï¼Œè¦è€—è´¹å¤§é‡æ—¶é—´ï¼›<br>
- äºŒæ¥å¦‚æœå¡«å†™çš„é‡å¾ˆå¤§ï¼Œå®¹æ˜“induce human errorâ€”â€”æ¼å­—ã€å¡«é”™ä½ç­‰ç­‰ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>ç”¨MS wordè‡ªå¸¦çš„<code>é‚®ä»¶åˆå¹¶ï¼ˆmail mergeï¼‰</code>åŠŸèƒ½</li>
<li>ç”¨Rè¯­è¨€çš„<code>officer::body_replace_all_text</code>å‡½æ•°</li>
</ol>
<p>æœ¬æ–‡ä»‹ç»ç¬¬äºŒä¸ªæ–¹æ¡ˆã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>éœ€æ±‚æè¿°ï¼š<br>
å·¥ä½œä¸­ï¼Œæœ‰æ—¶ä¼šé‡åˆ°éœ€è¦æ‰¹é‡å†™wordæ–‡æ¡£çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼Œå†™å‘å±•å…šå‘˜çš„æ‰¹æ–‡çš„æ—¶å€™ã€ä¸´è¿‘èŠ‚å‡æ—¥å†™å›°éš¾å…šå‘˜æ…°é—®ä¿¡çš„æ—¶å€™ã€å‘å±•å¯¹è±¡åŸ¹è®­ç­ç»“ä¸šå†™è¯ä¹¦ã€ç–«æƒ…æœŸé—´æ‰“å°é€šè¿‡å®¡æ ¸çš„é€šè¡Œè¯çš„æ—¶å€™ç­‰ç­‰ã€‚è¿™æ ·çš„æ–‡æ¡£å¤§éƒ¨åˆ†å†…å®¹æ˜¯ä¸å˜çš„ï¼Œåªæœ‰ä¸ªåˆ«å‡ ä¸ªåœ°æ–¹ï¼Œéœ€è¦å†™å…¥ä¿¡æ¯ã€‚è€Œè¿™äº›ä¿¡æ¯å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä»¥è¡¨æ ¼çš„å½¢å¼å‘ˆç°ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ¨ä¸ªæ‰‹åŠ¨å°†ä¿¡æ¯å¡«åˆ°wordæ–‡æ¡£ä¸­ï¼Œ<br>
- ä½†æ˜¯ä¸€æ¥é€Ÿåº¦ä¸å¿«ï¼Œè¦è€—è´¹å¤§é‡æ—¶é—´ï¼›<br>
- äºŒæ¥å¦‚æœå¡«å†™çš„é‡å¾ˆå¤§ï¼Œå®¹æ˜“induce human errorâ€”â€”æ¼å­—ã€å¡«é”™ä½ç­‰ç­‰ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>ç”¨MS wordè‡ªå¸¦çš„<code>é‚®ä»¶åˆå¹¶ï¼ˆmail mergeï¼‰</code>åŠŸèƒ½</li>
<li>ç”¨Rè¯­è¨€çš„<code>officer::body_replace_all_text</code>å‡½æ•°</li>
</ol>
<p>æœ¬æ–‡ä»‹ç»ç¬¬äºŒä¸ªæ–¹æ¡ˆã€‚</p>
<!-- more -->
<h1 id="ç”¨rè¯­è¨€æ‰¹é‡å†™wordæ–‡æ¡£ä¸€-å®ç°åŠŸèƒ½">ç”¨Rè¯­è¨€æ‰¹é‡å†™wordæ–‡æ¡£ï¼ˆä¸€ï¼‰â€”â€” å®ç°åŠŸèƒ½</h1>
<h2 id="set-working-directory">set working directory</h2>
<pre><code class="language-{r}">#### set working directory ####
# set the folder where the RScript locates as working dir (you need Rstudio to do this)
setwd(
  dirname(rstudioapi::getSourceEditorContext()$path)
)
</code></pre>
<h2 id="load-packages">load Packages</h2>
<pre><code class="language-{r}">#### load Packages ####
library(readxl)
library(officer)
library(stringr)
</code></pre>
<h2 id="create-output-directory">create output directory</h2>
<pre><code class="language-{r}">#### create output dir ####
current.time &lt;- Sys.time() # å…ˆæŠŠæ—¶é—´è®°ä¸‹æ¥ å…å¾—ç¨‹åºè·‘å¾—è¿‡ä¹… å‰åå‘½åä¸ä¸€è‡´
name.dir &lt;- paste0(&quot;output_&quot;,
                   format(current.time, &quot;%m%d_%H%M&quot;)
)
dir.create(name.dir)

path.tmp.dir &lt;- paste(&quot;.&quot;, name.dir, &quot;tmp/&quot;, sep = &quot;/&quot;)
dir.create(path.tmp.dir)
</code></pre>
<h2 id="load-ttinfo">load tt.info</h2>
<p>åœ¨Rè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠå˜é‡ï¼ˆVariablesï¼‰æ”¾åœ¨åˆ—ï¼ˆcolumnï¼‰ï¼Œæ¯ä¸€è¡Œï¼ˆrowï¼‰ä¸ºä¸€ä¸ªObservationã€‚</p>
<pre><code class="language-{r}">### load tt.info &lt;-----------------------
path.tt.info &lt;- &quot;./Data/ã€æ¨¡æ‹Ÿã€‘ç”Ÿæ´»å›°éš¾å…šå‘˜æ‘¸åº•ç»Ÿè®¡.xlsx&quot;

tt.info &lt;- readxl::read_excel(path = path.tt.info,
                              sheet = 1, skip = 0
                              )
</code></pre>
<img src="https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pic/img/202108220932708.png" width = "60%" />
<h2 id="write-word-docmument">write word docmument</h2>
<ul>
<li>
<p>é¦–å…ˆåˆ¶ä½œæ¨¡æ¿.docxæ–‡ä»¶ã€‚å°†éœ€è¦å¡«å…¥ä¿¡æ¯çš„ä½ç½®ï¼Œåšå¥½ã€æ ‡è®°ã€‘ï¼ˆå¦‚<code>namePerson</code>, <code>nameBank</code>, <code>account</code>)ã€‚</p>
<ul>
<li>
<p>â˜… å»ºè®®ï¼šå°†æ–‡å­— ä¸€æ¬¡æ€§ ç²˜è´´åˆ°æ–‡æ¡£ä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ã€æ ‡è®°çš„å†…å®¹ã€‘ï¼Œä½äºwordæ–‡æ¡£ä¸­çš„ åŒä¸€ä¸ªchunk çš„ åŒä¸€ä¸ªnodeä¸­ã€‚åä¹‹ï¼Œå¦‚æœå¯¹æ–‡æ¡£å¤šæ¬¡ç¼–è¾‘ï¼Œå¯èƒ½ä¼šä½¿å¾—ã€æ ‡è®°çš„å†…å®¹ã€‘ä¸åœ¨åŒä¸€ä¸ªnodeï¼Œæ­¤æ—¶<code>officer::body_replace_all_text</code>ä¼šè¯†åˆ«ä¸å‡ºæ¥ï¼Œæç¤ºï¼š</p>
<pre><code> In x$doc_obj$replace_all_text(old_value, new_value, only_at_cursor,  :
  Found 0 instances of '...' in the document.
</code></pre>
</li>
<li>
<p>è¿™é‡Œåé¢ä¼šå†™ä¸€ç¯‡æ–‡ç« ï¼Œå…·ä½“è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚</p>
</li>
</ul>
</li>
<li>
<p>ç”¨<code>officer::read_docx</code>è¯»å–ä½œä¸ºæ¨¡æ¿çš„.docxæ–‡ä»¶ã€‚</p>
<ul>
<li>.docxæ–‡ä»¶ä¸­çš„ä¿¡æ¯å°†ä»¥ ç±»å‹ï¼ˆclassï¼‰ä¸º<code>rdocx</code>çš„R object å‚¨å­˜</li>
<li>è¿™é‡Œæœ‰ä¸ªBUGï¼š<code>officer_doc %&gt;% body_replace_all_text(...)</code>åï¼Œ<code>officer_doc</code>ä¼šå˜æˆæ›¿æ¢åçš„å€¼ï¼ˆæ¨¡æ¿çš„å€¼ä¼šè¢«è¦†ç›–ï¼‰ï¼Œæ•…æ¯ä¸€ä¸ªObservationéƒ½å¿…é¡»é‡æ–°è¯»å–ä¸€æ¬¡æ¨¡æ¿ã€‚</li>
</ul>
  <img src="https://raw.githubusercontent.com/ezrilei/WhereThePicLay/pic/img/202108220924692.png" width = "80%" />
</li>
<li>
<p>ç”¨<code>officer::body_replace_all_text</code>æŠŠæ ‡è®°æ›¿æ¢ä¸ºè¦å¡«å…¥çš„æ–‡å­—ã€‚</p>
</li>
<li>
<p>æœ€åç”¨<code>print</code>å‡½æ•°æŠŠ<code>rdocx</code>è¾“å‡ºä¸ºpdfæ–‡ä»¶ã€‚</p>
</li>
</ul>
<pre><code class="language-{r}">#### write word documents ####
for(i in 1:nrow(tt.info)){
  # è¯»å– æ¨¡æ¿.docx &lt;-----------------------
  officer_doc &lt;- officer::read_docx(path = &quot;./Data/ã€æ¨¡æ¿ã€‘æ…°é—®ä¿¡.docx&quot;)
  
  # def variable
  namePerson &lt;- tt.info$å§“å[i]
  nameBank &lt;- tt.info$å¼€æˆ·è¡Œåç§°[i]
  account &lt;- tt.info$`å¼€æˆ·è¡Œè´¦å·ï¼ˆå¡å·ï¼‰`[i] %&gt;% as.character()
  
  # æ›¿æ¢
  doc_replaced &lt;- officer_doc %&gt;%
    body_replace_all_text(old_value = &quot;namePerson&quot;, 
                          new_value = namePerson, 
                          only_at_cursor = FALSE
    ) %&gt;%
    body_replace_all_text(old_value = &quot;nameBank&quot;, 
                          new_value = nameBank, 
                          only_at_cursor = FALSE
    ) %&gt;% 
    body_replace_all_text(old_value = &quot;account&quot;, 
                          new_value = account, 
                          only_at_cursor = FALSE
    )
  #&quot;./output_%m%d_%H%M/tmp/ã€å®‹æ±Ÿã€‘æ…°é—®ä¿¡.docx&quot;
  print(doc_replaced, 
        target = paste0(path.tmp.dir, i,&quot;ã€&quot;, namePerson, &quot;ã€‘&quot;, &quot;æ…°é—®ä¿¡.docx&quot;)
  )
  
  # progress msg
  print(
    paste0(i,&quot;ã€&quot;, namePerson, &quot;ã€‘&quot;, &quot;æ…°é—®ä¿¡.docx&quot;,&quot;  created âœ“&quot;)
    )
}
</code></pre>
<h2 id="merge-word-documents-into-a-single-docx-file">merge word documents into a single .docx file</h2>
<p>ä¸Šä¸€æ­¥ï¼Œæ¯ä¸ªæ–‡æ¡£å¡«å…¥äº†ä¸€ä¸ªObservationçš„ä¿¡æ¯ï¼Œäº§ç”Ÿäº†æ•°ä¸ªæ–‡æ¡£ã€‚å¦‚æœä½ æŠŠä¸€ä¸ªä¸ªæ‰“å¼€ï¼Œå†æ‰“å°ï¼Œè´¹æ—¶è´¹åŠ›ã€‚è€Œä½ è‚¯å®šä¼šè¢«æ–‡å°å®¤çš„å·¥ä½œäººå‘˜åæ§½çš„ã€‚æ‰€ä»¥ï¼Œä¸ºäº†å‡å°‘æ‰“å°è®¾ç½®çš„å·¥ä½œé‡ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ‰€æœ‰æ–‡æ¡£ï¼Œåˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡æ¡£çš„å†…å®¹ä¹‹é—´ï¼Œé€šè¿‡<code>åˆ†é¡µç¬¦ï¼ˆpage breakï¼‰</code>åˆ†éš”ã€‚</p>
<ul>
<li>
<p>å› æ­¤ï¼Œæˆ‘ä»¬è¯»å–ç¬¬ä¸€ä¸ªè¾“å‡ºçš„æ–‡æ¡£ï¼Œä»¥æ­¤ä¸ºåŸºç¡€ï¼Œä¾æ¬¡æŠŠ<code>åˆ†é¡µç¬¦</code>å’Œ<code>ä¸‹ä¸€ä¸ªæ–‡æ¡£çš„ä¿¡æ¯</code>æ”¾å…¥è¿™ä¸ª<code>rdocx</code>ï¼Œæœ€å<code>print</code>å‡ºæ¥å°±è¡Œäº†ã€‚</p>
</li>
<li>
<p>æœ‰æ—¶å€™ï¼Œé»˜è®¤çš„æ–‡ä»¶æ’åºä¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼Œæ¯”å¦‚ï¼š</p>
</li>
</ul>
<pre><code>&gt; list.files(path = path.tmp.dir)
  [1] &quot;1ã€å®‹æ±Ÿã€‘æ…°é—®ä¿¡.docx&quot;     &quot;10ã€æŸ´è¿›ã€‘æ…°é—®ä¿¡.docx&quot;    
  [3]&quot;100ã€å­™æ–°ã€‘æ…°é—®ä¿¡.docx&quot;   &quot;101ã€é¡¾å¤§å«‚ã€‘æ…°é—®ä¿¡.docx&quot;
  [5] &quot;102ã€å¼ é’ã€‘æ…°é—®ä¿¡.docx&quot;   &quot;103ã€å­™äºŒå¨˜ã€‘æ…°é—®ä¿¡.docx&quot; 
  ....
</code></pre>
<p>æ›´å¤šçš„æ—¶å€™æˆ‘ä»¬éœ€è¦å’Œ.xlsxè¡¨æ ¼çš„æ•°æ®é¡ºåºä¸€è‡´ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code>  [1] &quot;./output_0822_0956/tmp/1ã€å®‹æ±Ÿã€‘æ…°é—®ä¿¡.docx&quot;     
  [2] &quot;./output_0822_0956/tmp/2ã€å¢ä¿Šä¹‰ã€‘æ…°é—®ä¿¡.docx&quot;    
  [3] &quot;./output_0822_0956/tmp/3ã€å´ç”¨ã€‘æ…°é—®ä¿¡.docx&quot;    
  ....
</code></pre>
<p>æ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„ look behind<code>(?&lt;=pattern)</code>å’Œlook ahead positive assert<code>(?=pattern)</code>ï¼Œæ‰¾ä½äº<code>tmp/</code>åé¢ï¼Œ<code>ã€</code>å‰é¢çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰å†™åœ¨æ–‡ä»¶åä¸­çš„åºå·ï¼Œå°†å­—ç¬¦ä¸²åºå·è½¬æ¢æˆ<code>numeric()</code>ï¼Œå†æ’åº<code>order()</code>ã€‚</p>
<pre><code class="language-{r}">#### merge letters into a single word doc ####
# get ordered
doc.path &lt;- paste0(path.tmp.dir, 
                  list.files(path = path.tmp.dir)
)
idx &lt;- doc.path %&gt;% str_extract_all(pattern = &quot;(?&lt;=tmp/).+?(?=ã€)&quot;) %&gt;% unlist() %&gt;% as.numeric() %&gt;% order() 
doc.path &lt;- doc.path[idx]

# merge doc
doc_merge &lt;- officer::read_docx(path = doc.path[1])

for(i in 2:length(doc.path)){
 doc_merge &lt;- doc_merge %&gt;%
   body_add_break() %&gt;% # add a page break into an rdocx object
   body_add_docx(src = doc.path[i]) # add content of a docx into an rdocx object
 
 print(
   paste0(i, &quot;/&quot;, length(doc.path), &quot;  merged âœ“&quot;)
 )
}

 print(doc_merge, 
     target = paste0(name.dir,&quot;/&quot;, &quot;ã€&quot;, nrow(tt.info), &quot;ã€‘&quot;, &quot;æ…°é—®ä¿¡.docx&quot;)
     )
</code></pre>
<h1 id="ç”¨rè¯­è¨€æ‰¹é‡å†™wordæ–‡æ¡£äºŒ-parallelå¹¶è¡Œè¿ç®—">ç”¨Rè¯­è¨€æ‰¹é‡å†™wordæ–‡æ¡£ï¼ˆäºŒï¼‰â€”â€” parallelå¹¶è¡Œè¿ç®—</h1>
<p>Rè¯­è¨€é»˜è®¤åªåˆ©ç”¨CPUå•ä¸ªæ ¸å•çº¿ç¨‹ã€‚è€Œæ˜¾ç„¶æˆ‘ä»¬<code>write word docmument</code>é‚£ä¸€æ­¥ï¼Œå„ä¸ªå¾ªç¯ä¹‹é—´å¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œä¸å­˜åœ¨è°çš„inputä¾èµ–è°çš„outputçš„æƒ…å†µã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>parallel::parLapply</code>ï¼ŒæŠŠå„ä¸ªå¾ªç¯åˆ†ç»™å¤šä¸ªæ ¸å¤šä¸ªçº¿ç¨‹ï¼Œè¿›è¡Œå¹¶è¡Œè¿ç®—ï¼Œä»¥æœŸå‡å°‘ç­‰å¾…çš„æ—¶é—´ã€‚</p>
<pre><code class="language-{r}">#### set working directory ####
# set the folder where the RScript locates as working dir (you need Rstudio to do this)
setwd(
 dirname(rstudioapi::getSourceEditorContext()$path)
)

#### load Packages ####
library(readxl)
library(officer)
library(stringr)
library(parallel) # &lt;----------

#### create output dir ####
current.time &lt;- Sys.time() # å…ˆæŠŠæ—¶é—´è®°ä¸‹æ¥ å…å¾—ç¨‹åºè·‘å¾—è¿‡ä¹… å‰åå‘½åä¸ä¸€è‡´
name.dir &lt;- paste0(&quot;output_&quot;,
                  format(current.time, &quot;%m%d_%H%M&quot;)
)
dir.create(name.dir)

path.tmp.dir &lt;- paste(&quot;.&quot;, name.dir, &quot;tmp/&quot;, sep = &quot;/&quot;)
dir.create(path.tmp.dir)


### load tt.info &lt;-----------------------
path.tt.info &lt;- &quot;./Data/ã€æ¨¡æ‹Ÿã€‘ç”Ÿæ´»å›°éš¾å…šå‘˜æ‘¸åº•ç»Ÿè®¡.xlsx&quot;

tt.info &lt;- readxl::read_excel(path = path.tt.info,
                             sheet = 1, skip = 0
                             )


#### def  word documents Function ####

Fun.writeDoc &lt;- function(i){
 
 # è¯»å– æ¨¡æ¿.docx &lt;-----------------------
 officer_doc &lt;- officer::read_docx(path = &quot;./Data/ã€æ¨¡æ¿ã€‘æ…°é—®ä¿¡.docx&quot;)
 
 # def variable
 namePerson &lt;- tt.info$å§“å[i]
 nameBank &lt;- tt.info$å¼€æˆ·è¡Œåç§°[i]
 account &lt;- tt.info$`å¼€æˆ·è¡Œè´¦å·ï¼ˆå¡å·ï¼‰`[i] %&gt;% as.character()
 
 # æ›¿æ¢
 doc_replaced &lt;- officer_doc %&gt;%
   body_replace_all_text(old_value = &quot;namePerson&quot;, 
                         new_value = namePerson, 
                         only_at_cursor = FALSE
   ) %&gt;%
   body_replace_all_text(old_value = &quot;nameBank&quot;, 
                         new_value = nameBank, 
                         only_at_cursor = FALSE
   ) %&gt;% 
   body_replace_all_text(old_value = &quot;account&quot;, 
                         new_value = account, 
                         only_at_cursor = FALSE
   )
 #&quot;./output_%m%d_%H%M/tmp/ã€å®‹æ±Ÿã€‘æ…°é—®ä¿¡.docx&quot;
 print(doc_replaced, 
       target = paste0(path.tmp.dir, i,&quot;ã€&quot;, namePerson, &quot;ã€‘&quot;, &quot;æ…°é—®ä¿¡.docx&quot;)
 )
 
# progress msg
print(
   paste0(i,&quot;ã€&quot;, namePerson, &quot;ã€‘&quot;, &quot;æ…°é—®ä¿¡.docx&quot;,&quot;  created âœ“&quot;)
   )
} # End of def Fun.writeDoc

#### def Fun.loadPackages ####
Fun.loadPackages &lt;- function(packages) {
 for (p in packages) {
   library(p, character.only=TRUE)
 }
 NULL
} 

# detectCores() # 16
#### run parLapply ####
system.time({
 
 parallel.cl &lt;- makeCluster(12) # åˆå§‹åŒ–12æ ¸å¿ƒé›†ç¾¤
 clusterExport(parallel.cl, &quot;tt.info&quot;) #å°†tt.infoå¯¼å…¥æ‰€æœ‰cluster
 clusterExport(parallel.cl, &quot;name.dir&quot;)
 clusterExport(parallel.cl, &quot;path.tmp.dir&quot;)
 clusterCall(parallel.cl, Fun.loadPackages, c(&quot;readxl&quot;, &quot;officer&quot;, &quot;stringr&quot;)) # load package into all clusters
 
 i = 1:nrow(tt.info)
 parLapply(cl = parallel.cl, X = i, fun = Fun.writeDoc) # lapplyçš„å¹¶è¡Œç‰ˆæœ¬
 
 stopCluster(parallel.cl) # å…³é—­é›†ç¾¤
 
})
####_____________________####

#### merge letters into a single word doc ####
# get ordered
doc.path &lt;- paste0(path.tmp.dir, 
                  list.files(path = path.tmp.dir)
)
idx &lt;- doc.path %&gt;% str_extract_all(pattern = &quot;(?&lt;=tmp/).+?(?=ã€)&quot;) %&gt;% unlist() %&gt;% as.numeric() %&gt;% order() 
doc.path &lt;- doc.path[idx]

# merge doc
doc_merge &lt;- officer::read_docx(path = doc.path[1])

for(i in 2:length(doc.path)){
 doc_merge &lt;- doc_merge %&gt;%
   body_add_break() %&gt;% # add a page break into an rdocx object
   body_add_docx(src = doc.path[i]) # add content of a docx into an rdocx object
 
 print(
   paste0(i, &quot;/&quot;, length(doc.path), &quot;  merged âœ“&quot;)
 )
}


print(doc_merge, 
     target = paste0(name.dir,&quot;/&quot;, &quot;ã€&quot;, nrow(tt.info), &quot;ã€‘&quot;, &quot;æ…°é—®ä¿¡.docx&quot;)
)
</code></pre>
<h1 id="ç”¨rè¯­è¨€æ‰¹é‡å†™wordæ–‡æ¡£ä¸‰-å¸¸è§é—®é¢˜è§£å†³">ç”¨Rè¯­è¨€æ‰¹é‡å†™wordæ–‡æ¡£ï¼ˆä¸‰ï¼‰â€”â€” å¸¸è§é—®é¢˜è§£å†³</h1>
<h2 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h2>
<p>å‰æ–‡æåˆ°ï¼šå¯¹æ–‡æ¡£å¤šæ¬¡ç¼–è¾‘ï¼Œå¯èƒ½ä¼šä½¿å¾—ã€æ ‡è®°çš„å†…å®¹ã€‘ä¸åœ¨åŒä¸€ä¸ªnodeï¼Œæ­¤æ—¶<code>officer::body_replace_all_text</code>ä¼šè¯†åˆ«ä¸å‡ºæ¥ï¼Œæç¤ºï¼š</p>
<pre><code>In x$doc_obj$replace_all_text(old_value, new_value, only_at_cursor,  :
  Found 0 instances of '...' in the document.
</code></pre>
<h2 id="åŸå› æ¢ç©¶">åŸå› æ¢ç©¶</h2>
<p>å‚è€ƒï¼š<a href="https://stackoverflow.com/questions/51047772/doesnt-work-body-replace-all-text-method-in-package-officer">David Gohel, stackoverflowçš„å›ç­”</a></p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨é€šè¿‡<code>officer::docx_show_chunk()</code>æ˜¾ç¤º<code>rdocx</code> R object æ¯ä¸ªchunkçš„å†…å®¹ã€‚</p>
<pre><code class="language-{r}">&gt; officer_doc &lt;- officer::read_docx(path = &quot;./Data/ã€æ¨¡æ¿ã€‘æ…°é—®ä¿¡.docx&quot;)
&gt; officer_doc %&gt;% cursor_begin() %&gt;% 
+   cursor_forward %&gt;% 
+   cursor_forward %&gt;% 
+   cursor_forward %&gt;% 
+   cursor_forward %&gt;% 
+   #cursor_forward %&gt;%
+   docx_show_chunk()
18 text nodes found at this cursor. 
 &lt;w:t&gt;: 'å¥‹æ–—ç™¾å¹´è·¯ï¼Œå¯èˆªæ–°å¾ç¨‹ã€‚å¸Œæœ›æ‚¨ç»§ç»­å‘æŒ¥'
 &lt;w:t&gt;: 'å…šå‘˜'
 &lt;w:t&gt;: 'æ¨¡èŒƒå¸¦å¤´ä½œç”¨ï¼Œ'
 &lt;w:t&gt;: 'ä¸€å¦‚æ—¢å¾€åœ°'
 &lt;w:t&gt;: 'æ”¯æŒå…¨è¡—ç»æµç¤¾ä¼šå„é¡¹å·¥ä½œã€‚'
 &lt;w:t&gt;: 'ç°å°†'
 &lt;w:t&gt;: 'æ…°é—®é‡‘å£¹ä»Ÿå…ƒæ•´ï¼ˆ'
 &lt;w:t&gt;: '1000'
 &lt;w:t&gt;: 'å…ƒï¼‰'
 &lt;w:t&gt;: 'æ±‡å…¥'
 &lt;w:t&gt;: 'æ‚¨çš„'
 &lt;w:t&gt;: 'name'
 &lt;w:t&gt;: 'B'
 &lt;w:t&gt;: 'ank'
 &lt;w:t&gt;: 'è´¦æˆ·'
 &lt;w:t&gt;: 'account'
 &lt;w:t&gt;: 'ï¼Œè¯·æŸ¥æ”¶'
 &lt;w:t&gt;: 'ã€‚'
</code></pre>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è®¡åˆ’ä½œä¸ºæ ‡è®°çš„<code>nameBank</code>è¢«åˆ†åˆ°3ä¸ªnodesä¸­ï¼š</p>
<pre><code> &lt;w:t&gt;: 'name'
 &lt;w:t&gt;: 'B'
 &lt;w:t&gt;: 'ank'
</code></pre>
<p>è¿™æ ·çš„æƒ…å†µ<code>officer::body_replace_all_text</code>å‡½æ•°è¯†åˆ«ä¸å‡ºæ¥ï¼Œå°±ä¼šæç¤º<code>Found 0 instances of 'nameBank' in the document.</code>ã€‚</p>
<h2 id="è§£å†³åŠæ³•">è§£å†³åŠæ³•</h2>
<ol>
<li>
<p>æŠŠè¿™ä¸€æ®µçš„å†…å®¹åˆ å»ï¼ˆdeleteï¼‰ã€‚</p>
</li>
<li>
<p>æŠŠè¿™ä¸€æ®µçš„å†…å®¹ç²˜åˆ°æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆä»¥å»é™¤æ ¼å¼ï¼‰</p>
</li>
<li>
<p>æŠŠæ–‡æœ¬ç¼–è¾‘å™¨çš„è¿™ä¸€æ®µçš„å†…å®¹ å†ä¸€å—å„¿ç²˜å›åˆ°wordæ–‡æ¡£ã€‚</p>
<p>æˆ‘ä»¬ä¼šå‘ç°ï¼šæˆ‘ä»¬å†™çš„æ ‡è®°å·²ç»ä½äºåŒä¸€chunkçš„åŒä¸€nodeä¸­äº†<code>&lt;w:t&gt;: 'nameBank'</code>ã€‚</p>
<pre><code>&gt; officer_doc &lt;- officer::read_docx(path = &quot;./Data/ã€æ¨¡æ¿ã€‘æ…°é—®ä¿¡.docx&quot;)
&gt; officer_doc %&gt;% cursor_begin() %&gt;% 
+   cursor_forward %&gt;% 
+   cursor_forward %&gt;% 
+   cursor_forward %&gt;% 
+   cursor_forward %&gt;% 
+   #cursor_forward %&gt;%
+   docx_show_chunk()
7 text nodes found at this cursor. 
  &lt;w:t&gt;: 'å¥‹æ–—ç™¾å¹´è·¯ï¼Œå¯èˆªæ–°å¾ç¨‹ã€‚å¸Œæœ›æ‚¨ç»§ç»­å‘æŒ¥å…šå‘˜æ¨¡èŒƒå¸¦å¤´ä½œç”¨ï¼Œä¸€å¦‚æ—¢å¾€åœ°æ”¯æŒå…¨è¡—ç»æµç¤¾ä¼šå„é¡¹å·¥ä½œã€‚ç°å°†æ…°é—®é‡‘å£¹ä»Ÿå…ƒæ•´ï¼ˆ'
  &lt;w:t&gt;: '1000'
  &lt;w:t&gt;: 'å…ƒï¼‰æ±‡å…¥æ‚¨çš„'
  &lt;w:t&gt;: 'nameBank'
  &lt;w:t&gt;: 'è´¦æˆ·'
  &lt;w:t&gt;: 'account'
  &lt;w:t&gt;: 'ï¼Œè¯·æŸ¥æ”¶ã€‚'
</code></pre>
</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://ezrilei.github.io/post/hello-gridea/</id>
        <link href="https://ezrilei.github.io/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>